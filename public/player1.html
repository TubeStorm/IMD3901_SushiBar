<!DOCTYPE html>
<html>
	<head>
		<title>Sushi バー</title>
	<script src="/js/aframe.min.js"></script> <!-- https://github.com/aframevr/aframe -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="/js/spherical-env-map.js"></script> <!-- https://github.com/aframevr/aframe -->
	<script src="/js/load-props.js"></script>
	<script src="/js/npc-create.js"></script>
	<script src="/js/timer.js"></script>
  <script src="/js/raycaster-listen.js"></script>
  </head>
        <body>
            <h1></h1>
            <a-scene time shadow="type:basic;" >
                    <a-assets timeout="4000">
													<!--LOADING KITCHEN-->
	                        <a-asset-item id="kitchenEnviro-obj" src="/assets/models/kitchenEnviro/kitchen.obj"></a-asset-item>
	                        <img id="kitchenEnviroFloor-mtl" src="/assets/models/kitchenEnviro/texture.png"></img>
													<!--SOUND LOAD SRC-->
													 <audio id="music-sound" src="/assets/sounds/music_v02.mp3"></audio>
													 <audio id="recharge-sound" src="/assets/sounds/recharge.wav"></audio>
													 <audio id="dingCounter-sound" src="/assets/sounds/dingCounter.wav"></audio>
													 <audio id="pop-sound" src="/assets/sounds/pop.wav"></audio>

	                        <!--LOADING DECORATIONS-->
	                        <a-asset-item id="canD-obj" src="/assets/models/kitchenEnviro/decorations/can/can.obj"></a-asset-item>
	                        <img id="canD-mtl" src="/assets/models/kitchenEnviro/decorations/can/can.png"></img>

	                        <a-asset-item id="cucumberD-obj" src="/assets/models/kitchenEnviro/decorations/cucumber/cucumber.obj"></a-asset-item>
	                        <img id="cucumberD-mtl" src="/assets/models/kitchenEnviro/decorations/cucumber/cucumber.png"></img>

	                        <a-asset-item id="cucumberSliceD-obj" src="/assets/models/kitchenEnviro/decorations/cucumber/cucumber_sliced.obj"></a-asset-item>
	                        <img id="cucumberSliceD-mtl" src="/assets/models/kitchenEnviro/decorations/cucumber/cucumber_sliced.png"></img>

	                        <a-asset-item id="cupD-obj" src="/assets/models/kitchenEnviro/decorations/cup/cup.obj"></a-asset-item>
	                        <img id="cupD-mtl" src="/assets/models/kitchenEnviro/decorations/cup/cup.png"></img>

	                        <a-asset-item id="knifeD-obj" src="/assets/models/kitchenEnviro/decorations/knife/knife.obj"></a-asset-item>
	                        <img id="knifeD-mtl" src="/assets/models/kitchenEnviro/decorations/knife/knife.png"></img>

	                        <a-asset-item id="matD-obj" src="/assets/models/kitchenEnviro/decorations/mat/mat.obj"></a-asset-item>
	                        <img id="matD-mtl" src="/assets/models/kitchenEnviro/decorations/mat/mat.png"></img>

	                        <a-asset-item id="riceD-obj" src="/assets/models/kitchenEnviro/decorations/rice/rice.obj"></a-asset-item>
	                        <img id="riceD-mtl" src="/assets/models/kitchenEnviro/decorations/rice/rice.png"></img>

	                        <a-asset-item id="seaweed1D-obj" src="/assets/models/kitchenEnviro/decorations/seaweed/seaweed1.obj"></a-asset-item>
	                        <img id="seaweed1D-mtl" src="/assets/models/kitchenEnviro/decorations/seaweed/seaweed1.png"></img>

	                        <a-asset-item id="seaweed2D-obj" src="/assets/models/kitchenEnviro/decorations/seaweed/seaweed2.obj"></a-asset-item>
	                        <img id="seaweed2D-mtl" src="/assets/models/kitchenEnviro/decorations/seaweed/seaweed2.png"></img>

	                        <!--LOADING PROPS-->
	                        <a-asset-item id="avocado-obj" src="/assets/models/kitchenEnviro/props/avocado/avocado.obj"></a-asset-item>
	                        <img id="avocado-mtl" src="/assets/models/kitchenEnviro/props/avocado/avocado.png"></img>

	                        <a-asset-item id="cucumber-obj" src="/assets/models/kitchenEnviro/props/cucumber/cucumber.obj"></a-asset-item>
	                        <img id="cucumber-mtl" src="/assets/models/kitchenEnviro/props/cucumber/cucumber.png"></img>

	                        <a-asset-item id="knife-obj" src="/assets/models/kitchenEnviro/props/knife/knife.obj"></a-asset-item>
	                        <img id="knife-mtl" src="/assets/models/kitchenEnviro/props/knife/knife.png"></img>

	                        <a-asset-item id="cup-obj" src="/assets/models/kitchenEnviro/props/cup/cup.obj"></a-asset-item>
	                        <img id="cup-mtl" src="/assets/models/kitchenEnviro/props/cup/cup.png"></img>

	                        <a-asset-item id="rice-obj" src="/assets/models/kitchenEnviro/props/rice/rice.obj"></a-asset-item>
	                        <img id="rice-mtl" src="/assets/models/kitchenEnviro/props/rice/rice.png"></img>

	                        <a-asset-item id="salmon-obj" src="/assets/models/kitchenEnviro/props/salmon/salmon.obj"></a-asset-item>
	                        <img id="salmon-mtl" src="/assets/models/kitchenEnviro/props/salmon/salmon.png"></img>

	                        <a-asset-item id="seaweed-obj" src="/assets/models/kitchenEnviro/props/seaweed/seaweed.obj"></a-asset-item>
	                        <img id="seaweed-mtl" src="/assets/models/kitchenEnviro/props/seaweed/seaweed.png"></img>

	                        <a-asset-item id="servebar-obj" src="/assets/models/kitchenEnviro/props/servebar/servebar.obj"></a-asset-item>
	                        <img id="servebar-mtl" src="/assets/models/kitchenEnviro/texture.png"></img>

													<!--LOADING NPC-->
													<a-asset-item id="male2-obj" src="/assets/models/npc/Male1/male1.obj"></a-asset-item>
													<img id="male2-mtl" src="/assets/models/npc/Male1/final_texture.png"></img>

													<!--LOADING HUD-->
													<a-asset-item id="hudBoard-obj" src="/assets/models/kitchenEnviro/HUD/board.obj"></a-asset-item>
													<img id="hudBoard-avo-mtl" src="/assets/models/kitchenEnviro/HUD/board_avo.png"></img>
													<img id="hudBoard-avoCheck-mtl" src="/assets/models/kitchenEnviro/HUD/board_avo_check.png"></img>
													<img id="hudBoard-rice-mtl" src="/assets/models/kitchenEnviro/HUD/board_rice.png"></img>
													<img id="hudBoard-riceCheck-mtl" src="/assets/models/kitchenEnviro/HUD/board_rice_check.png"></img>
													<img id="hudBoard-cucumber-mtl" src="/assets/models/kitchenEnviro/HUD/board_cuc.png"></img>
													<img id="hudBoard-cucumberCheck-mtl" src="/assets/models/kitchenEnviro/HUD/board_cuc_check.png"></img>
													<img id="hudBoard-salmon-mtl" src="/assets/models/kitchenEnviro/HUD/board_sal.png"></img>
													<img id="hudBoard-salmonCheck-mtl" src="/assets/models/kitchenEnviro/HUD/board_sal_check.png"></img>
													<img id="hudBoard-seaweed-mtl" src="/assets/models/kitchenEnviro/HUD/board_sea.png"></img>
													<img id="hudBoard-seaweedCheck-mtl" src="/assets/models/kitchenEnviro/HUD/board_sea_check.png"></img>

		</a-assets>
                <!--CAMERA CONTROLS-->
                <a-entity id="mainCamera" position="0 40 -1"  camera look-controls>
								<a-entity cursor="fuse:false; fuseTimeout:1000; rayOrigin:mouse"
												position="0 0 -1">
								</a-entity>
								<a-text 	value="Welcome to the Sushi Bar"
													position="-1.8 0.75 -1"
													color="black"
													width="3"
													anchor="left">

								</a-text>
								<a-text id="timerTXT"
										value="TIME LEFT: "
										position="1 0.75 -1"
										color="black"
										width="2"
										anchor="left">

										<a-text id="timerNUMBERS" position="1.75 0.75 -1" width="6" color="black" text=" "></a-text>

									</a-text>
                </a-entity>

								<!--LIGHTING-->
                <a-entity light="type:directional; castShadow:false; intensity:0.6; shadowBias:-0.000001; shadowMapWidth:1024; shadowMapHeight:1024;" position="-0.5 1 1"></a-entity>
                <a-entity light="type: ambient; intensity: 0.9; color:#bbb;"></a-entity>

								<!--SOUND-->
								<a-entity id="ding" sound="src:#dingCounter-sound;"></a-entity>
							  <a-entity id="recharge" sound="src:#recharge-sound;"></a-entity>
								<a-entity id="pop" sound="src:#pop-sound;"></a-entity>

                <!--KITCHEN-->
                <a-obj-model load-props timer sound="src:#music-sound; autoplay:true; loop:true" src="#kitchenEnviro-obj" material="src:#kitchenEnviroFloor-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <!--DECORATIONS (can't be interacted with)-->
                <a-obj-model src="#canD-obj" material="src:#canD-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model src="#cucumberD-obj" material="src:#cucumberD-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model src="#cucumberSliceD-obj" material="src:#cucumberSliceD-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model src="#cupD-obj" material="src:#cupD-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model src="#knifeD-obj" material="src:#knifeD-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model src="#matD-obj" material="src:#matD-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model src="#seaweed1D-obj" material="src:#seaweed1D-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model src="#seaweed2D-obj" material="src:#seaweed2D-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>

                <!--PROPS-->             
                <a-obj-model id="avocado" src="#avocado-obj" material="src:#avocado-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model id="cucumber" src="#cucumber-obj" material="src:#cucumber-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model id="knife" src="#knife-obj" material="src:#knife-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model id="cup" src="#cup-obj" material="src:#cup-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model id="rice" src="#rice-obj" material="src:#rice-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model id="salmon" src="#salmon-obj" material="src:#salmon-mtl" position="43.559 -0.657 -13.436" rotation="0 100.000 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model id="seaweed" src="#seaweed-obj" material="src:#seaweed-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <a-obj-model npc-create id="bar" src="#servebar-obj" material="src:#servebar-mtl" position="0 0 0" rotation="0 0 0" scale="0.5 0.5 0.5" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>

                <!--NPC-->   
                <a-obj-model id="npc" src="#male2-obj" material="src:#male2-mtl" position="-51.837 0 0" rotation="0 90 0" scale="0.3 0.3 0.3" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
                <!--HUD--> 
								<a-obj-model id="hudBoard" src="#hudBoard-obj" material="src:#hudBoard-avo-mtl" position="15.590 32.0 -30.489" rotation="0 0 0" scale="4 4 4" shadow="cast:false; receive:false;" spherical-env-map="src:#skymap;"></a-obj-model>
					  
            </a-scene>


            <script src="/socket.io/socket.io.js"></script>
            <script>
                let socket = io();

                //default connect event
                 socket.on('connect', function() {
					console.log("connected!");

				 });


				  document.querySelector('#avocado').addEventListener('click', function() {
					  console.log("passing through server");
					socket.emit('moveClickP2');

				});

			socket.on('moveP1', function(data) {
                //create rgb color string for css
                let coordinates = 'xyz(' + data.x + ',' + data.y + ',' + data.z + ')';
                console.log("coordinates recieved: " + coordinates);


			});

            </script>
		</body>
	</head>
</html>
